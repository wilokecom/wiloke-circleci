version: 2.1
jobs:
  build:
    docker:
#      - image: circleci/php:7.4-node-browsers
      - image: circleci/mysql:5.7
      - image: circleci/buildpack-deps:curl
#        environment:
#          MYSQL_DATABASE: $DB_NAME
#          MYSQL_USER: $DB_USER
#          MYSQL_PASSWORD: $DB_PASSWORD
#          MYSQL_ROOT_PASSWORD: root
#          MYSQL_TCP_PORT: 3306
#          MYSQL_UNIX_PORT: 3306
    environment:
      WORKSPACE_ROOT: tmp/
      DB_NAME: wordpress
      DB_USER: wordpress
      DB_PASSWORD: 123456
      DB_HOST: 127.0.0.1
      WORKING_DIR: ~/var/www/html
      WP_ADMIN: /var/www/html
      WP_PASSWORD: /var/www/html
      WP_EMAIL: /var/www/html
      WP_URL: http://localhost
    working_directory: ~/wiloke-circleci
    steps:
      - checkout
      - run:
          name: Creating workspace
          command: mkdir ~/tmp
      - run:
          name: Checking folder
          command: ls -la ~/
      - persist_to_workspace:
          root: .
          paths:
            - .
      - run:
          name: Downloading WordPress
          command: .circleci/install-wp-cli.sh
workflows:
  build_test_deploy:
    jobs:
      - build
